[
  {
    "primitive_id": "PS-001",
    "primitive_command": "hostname",
    "intent": [
      "System Information Discovery"
    ],
    "mitre_ttps": [
      "T1082"
    ],
    "telemetry_rules": [
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4103,
        "details": "powershell.exe -Command hostname"
      },
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4104,
        "details": "hostname"
      }
    ]
  },
  {
    "primitive_id": "PS-002",
    "primitive_command": "Get-CimInstance -ClassName Win32_OperatingSystem | Select-Object -Property Caption, Version",
    "intent": [
      "System Information Discovery"
    ],
    "mitre_ttps": [
      "T1082"
    ],
    "telemetry_rules": []
  },
  {
    "primitive_id": "PS-003",
    "primitive_command": "Get-Command Get-Process",
    "intent": [
      "System Information Discovery",
      "Software Discovery"
    ],
    "mitre_ttps": [
      "T1082",
      "T1518"
    ],
    "telemetry_rules": [
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4103,
        "details": "powershell.exe -Command Get-Command Get-Process"
      },
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4104,
        "details": "Get-Command Get-Process"
      }
    ]
  },
  {
    "primitive_id": "PS-004",
    "primitive_command": "Get-Module",
    "intent": [
      "Software Discovery"
    ],
    "mitre_ttps": [
      "T1518"
    ],
    "telemetry_rules": [
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4103,
        "details": "powershell.exe -Command Get-Module"
      },
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4104,
        "details": "Get-Module"
      }
    ]
  },
  {
    "primitive_id": "PS-005",
    "primitive_command": "Get-ChildItem Env:",
    "intent": [
      "System Information Discovery",
      "System Owner/User Discovery"
    ],
    "mitre_ttps": [
      "T1082",
      "T1033"
    ],
    "telemetry_rules": [
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4103,
        "details": "powershell.exe -Command Get-ChildItem Env:"
      },
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4104,
        "details": "Get-ChildItem Env:"
      }
    ]
  },
  {
    "primitive_id": "PS-006",
    "primitive_command": "dir C:\\Windows",
    "intent": [
      "File and Directory Discovery"
    ],
    "mitre_ttps": [
      "T1083"
    ],
    "telemetry_rules": [
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4103,
        "details": "powershell.exe -Command dir C:\\Windows"
      },
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4104,
        "details": "dir C:\\Windows"
      }
    ]
  },
  {
    "primitive_id": "PS-007",
    "primitive_command": "tree /F C:\\Windows\\System32\\drivers\\etc",
    "intent": [
      "File and Directory Discovery"
    ],
    "mitre_ttps": [
      "T1083"
    ],
    "telemetry_rules": [
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4103,
        "details": "powershell.exe -Command tree /F C:\\Windows\\System32\\drivers\\etc"
      },
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4104,
        "details": "tree /F C:\\Windows\\System32\\drivers\\etc"
      }
    ]
  },
  {
    "primitive_id": "PS-008",
    "primitive_command": "Get-Content C:\\Windows\\System32\\drivers\\etc\\hosts",
    "intent": [
      "File and Directory Discovery",
      "System Network Configuration Discovery"
    ],
    "mitre_ttps": [
      "T1083",
      "T1016"
    ],
    "telemetry_rules": [
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4103,
        "details": "powershell.exe -Command Get-Content C:\\Windows\\System32\\drivers\\etc\\hosts"
      },
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4104,
        "details": "Get-Content C:\\Windows\\System32\\drivers\\etc\\hosts"
      }
    ]
  },
  {
    "primitive_id": "PS-009",
    "primitive_command": "whoami",
    "intent": [
      "System Owner/User Discovery"
    ],
    "mitre_ttps": [
      "T1033"
    ],
    "telemetry_rules": [
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4103,
        "details": "powershell.exe -Command whoami"
      },
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4104,
        "details": "whoami"
      }
    ]
  },
  {
    "primitive_id": "PS-010",
    "primitive_command": "whoami /priv",
    "intent": [
      "Permission Groups Discovery"
    ],
    "mitre_ttps": [
      "T1069"
    ],
    "telemetry_rules": [
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4103,
        "details": "powershell.exe -Command whoami /priv"
      },
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4104,
        "details": "whoami /priv"
      }
    ]
  },
  {
    "primitive_id": "PS-011",
    "primitive_command": "whoami /groups",
    "intent": [
      "Permission Groups Discovery"
    ],
    "mitre_ttps": [
      "T1069"
    ],
    "telemetry_rules": [
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4103,
        "details": "powershell.exe -Command whoami /groups"
      },
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4104,
        "details": "whoami /groups"
      }
    ]
  },
  {
    "primitive_id": "PS-012",
    "primitive_command": "net user",
    "intent": [
      "Account Discovery"
    ],
    "mitre_ttps": [
      "T1087"
    ],
    "telemetry_rules": [
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4103,
        "details": "powershell.exe -Command net user"
      },
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4104,
        "details": "net user"
      }
    ]
  },
  {
    "primitive_id": "PS-013",
    "primitive_command": "net localgroup",
    "intent": [
      "Local Groups"
    ],
    "mitre_ttps": [
      "T1069.001"
    ],
    "telemetry_rules": [
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4103,
        "details": "powershell.exe -Command net localgroup"
      },
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4104,
        "details": "net localgroup"
      }
    ]
  },
  {
    "primitive_id": "PS-014",
    "primitive_command": "Get-LocalUser",
    "intent": [
      "Account Discovery: Local Account"
    ],
    "mitre_ttps": [
      "T1087.001"
    ],
    "telemetry_rules": [
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4103,
        "details": "powershell.exe -Command Get-LocalUser"
      },
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4104,
        "details": "Get-LocalUser"
      }
    ]
  },
  {
    "primitive_id": "PS-015",
    "primitive_command": "Get-LocalGroup",
    "intent": [
      "Local Groups"
    ],
    "mitre_ttps": [
      "T1069.001"
    ],
    "telemetry_rules": [
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4103,
        "details": "powershell.exe -Command Get-LocalGroup"
      },
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4104,
        "details": "Get-LocalGroup"
      }
    ]
  },
  {
    "primitive_id": "PS-016",
    "primitive_command": "Get-LocalGroupMember -Group \"Administrators\"",
    "intent": [
      "Local Groups"
    ],
    "mitre_ttps": [
      "T1069.001"
    ],
    "telemetry_rules": [
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4103,
        "details": "powershell.exe -Command Get-LocalGroupMember -Group Administrators"
      },
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4104,
        "details": "Get-LocalGroupMember -Group Administrators"
      }
    ]
  },
  {
    "primitive_id": "PS-017",
    "primitive_command": "ipconfig /all",
    "intent": [
      "System Network Configuration Discovery"
    ],
    "mitre_ttps": [
      "T1016"
    ],
    "telemetry_rules": [
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4103,
        "details": "powershell.exe -Command ipconfig /all"
      },
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4104,
        "details": "ipconfig /all"
      }
    ]
  },
  {
    "primitive_id": "PS-018",
    "primitive_command": "arp -a",
    "intent": [
      "Remote System Discovery"
    ],
    "mitre_ttps": [
      "T1018"
    ],
    "telemetry_rules": [
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4103,
        "details": "powershell.exe -Command arp -a"
      },
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4104,
        "details": "arp -a"
      }
    ]
  },
  {
    "primitive_id": "PS-019",
    "primitive_command": "netstat -an",
    "intent": [
      "System Network Connections Discovery",
      "Network Service Discovery"
    ],
    "mitre_ttps": [
      "T1049",
      "T1046"
    ],
    "telemetry_rules": [
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4103,
        "details": "powershell.exe -Command netstat -an"
      },
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4104,
        "details": "netstat -an"
      }
    ]
  },
  {
    "primitive_id": "PS-020",
    "primitive_command": "nslookup www.google.com",
    "intent": [
      "Internet Connection Discovery"
    ],
    "mitre_ttps": [
      "T1016.001"
    ],
    "telemetry_rules": [
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4103,
        "details": "powershell.exe -Command nslookup www.google.com"
      },
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4104,
        "details": "nslookup www.google.com"
      }
    ]
  },
  {
    "primitive_id": "PS-021",
    "primitive_command": "net share",
    "intent": [
      "Network Share Discovery"
    ],
    "mitre_ttps": [
      "T1135"
    ],
    "telemetry_rules": [
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4103,
        "details": "powershell.exe -Command net share"
      },
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4104,
        "details": "net share"
      }
    ]
  },
  {
    "primitive_id": "PS-022",
    "primitive_command": "Get-NetIPAddress",
    "intent": [
      "System Network Configuration Discovery"
    ],
    "mitre_ttps": [
      "T1016"
    ],
    "telemetry_rules": [
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4103,
        "details": "powershell.exe -Command Get-NetIPAddress"
      },
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4104,
        "details": "function __cmdletization_BindCommonParameters\n{\n    param(\n        $__cmdletization_objectModelWrapper,\n        $myPSBoundParameters\n    )       \n                \n\n        if ($myPSBoundParameters.ContainsKey('CimSession')) { \n            $__cmdletization_objectModelWrapper.PSObject.Properties['CimSession'].Value = $myPSBoundParameters['CimSession'] \n        }\n                    \n\n        if ($myPSBoundParameters.ContainsKey('ThrottleLimit')) { \n            $__cmdletization_objectModelWrapper.PSObject.Properties['ThrottleLimit'].Value = $myPSBoundParameters['ThrottleLimit'] \n        }\n                    \n\n        if ($myPSBoundParameters.ContainsKey('AsJob')) { \n            $__cmdletization_objectModelWrapper.PSObject.Properties['AsJob'].Value = $myPSBoundParameters['AsJob'] \n        }\n                    \n\n}"
      }
    ]
  },
  {
    "primitive_id": "PS-023",
    "primitive_command": "Get-NetRoute",
    "intent": [
      "System Network Configuration Discovery"
    ],
    "mitre_ttps": [
      "T1016"
    ],
    "telemetry_rules": [
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4103,
        "details": "powershell.exe -Command Get-NetRoute"
      },
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4104,
        "details": "function __cmdletization_BindCommonParameters\n{\n    param(\n        $__cmdletization_objectModelWrapper,\n        $myPSBoundParameters\n    )       \n                \n\n        if ($myPSBoundParameters.ContainsKey('CimSession')) { \n            $__cmdletization_objectModelWrapper.PSObject.Properties['CimSession'].Value = $myPSBoundParameters['CimSession'] \n        }\n                    \n\n        if ($myPSBoundParameters.ContainsKey('ThrottleLimit')) { \n            $__cmdletization_objectModelWrapper.PSObject.Properties['ThrottleLimit'].Value = $myPSBoundParameters['ThrottleLimit'] \n        }\n                    \n\n        if ($myPSBoundParameters.ContainsKey('AsJob')) { \n            $__cmdletization_objectModelWrapper.PSObject.Properties['AsJob'].Value = $myPSBoundParameters['AsJob'] \n        }\n                    \n\n}"
      }
    ]
  },
  {
    "primitive_id": "PS-024",
    "primitive_command": "Get-NetNeighbor",
    "intent": [
      "Remote System Discovery"
    ],
    "mitre_ttps": [
      "T1018"
    ],
    "telemetry_rules": [
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4103,
        "details": "powershell.exe -Command Get-NetNeighbor"
      },
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4104,
        "details": "function __cmdletization_BindCommonParameters\n{\n    param(\n        $__cmdletization_objectModelWrapper,\n        $myPSBoundParameters\n    )       \n                \n\n        if ($myPSBoundParameters.ContainsKey('CimSession')) { \n            $__cmdletization_objectModelWrapper.PSObject.Properties['CimSession'].Value = $myPSBoundParameters['CimSession'] \n        }\n                    \n\n        if ($myPSBoundParameters.ContainsKey('ThrottleLimit')) { \n            $__cmdletization_objectModelWrapper.PSObject.Properties['ThrottleLimit'].Value = $myPSBoundParameters['ThrottleLimit'] \n        }\n                    \n\n        if ($myPSBoundParameters.ContainsKey('AsJob')) { \n            $__cmdletization_objectModelWrapper.PSObject.Properties['AsJob'].Value = $myPSBoundParameters['AsJob'] \n        }\n                    \n\n}"
      }
    ]
  },
  {
    "primitive_id": "PS-025",
    "primitive_command": "Get-Service",
    "intent": [
      "System Service Discovery"
    ],
    "mitre_ttps": [
      "T1007"
    ],
    "telemetry_rules": [
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4103,
        "details": "powershell.exe -Command Get-Service"
      },
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4104,
        "details": "Get-Service"
      }
    ]
  },
  {
    "primitive_id": "PS-026",
    "primitive_command": "sc.exe query",
    "intent": [
      "System Service Discovery"
    ],
    "mitre_ttps": [
      "T1007"
    ],
    "telemetry_rules": [
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4103,
        "details": "powershell.exe -Command sc.exe query"
      },
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4104,
        "details": "sc.exe query"
      }
    ]
  },
  {
    "primitive_id": "PS-027",
    "primitive_command": "net start",
    "intent": [
      "System Service Discovery"
    ],
    "mitre_ttps": [
      "T1007"
    ],
    "telemetry_rules": [
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4103,
        "details": "powershell.exe -Command net start"
      },
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4104,
        "details": "net start"
      }
    ]
  },
  {
    "primitive_id": "PS-028",
    "primitive_command": "Get-CimInstance -ClassName Win32_Service | Select-Object State, Name, ProcessId, StartMode",
    "intent": [
      "System Service Discovery",
      "Process Discovery"
    ],
    "mitre_ttps": [
      "T1007",
      "T1057"
    ],
    "telemetry_rules": []
  },
  {
    "primitive_id": "PS-029",
    "primitive_command": "schtasks /query",
    "intent": [
      "Scheduled Task/Job: Scheduled Task"
    ],
    "mitre_ttps": [
      "T1053.005"
    ],
    "telemetry_rules": [
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4103,
        "details": "powershell.exe -Command schtasks /query"
      },
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4104,
        "details": "schtasks /query"
      }
    ]
  },
  {
    "primitive_id": "PS-030",
    "primitive_command": "REG QUERY HKLM\\Software\\Microsoft\\Windows\\CurrentVersion",
    "intent": [
      "Query Registry"
    ],
    "mitre_ttps": [
      "T1012"
    ],
    "telemetry_rules": [
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4103,
        "details": "powershell.exe -Command REG QUERY HKLM\\Software\\Microsoft\\Windows\\CurrentVersion"
      },
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4104,
        "details": "REG QUERY HKLM\\Software\\Microsoft\\Windows\\CurrentVersion"
      }
    ]
  },
  {
    "primitive_id": "PS-031",
    "primitive_command": "findstr \"127.0.0.1\" C:\\Windows\\System32\\drivers\\etc\\hosts",
    "intent": [
      "File and Directory Discovery",
      "System Network Configuration Discovery"
    ],
    "mitre_ttps": [
      "T1083",
      "T1016"
    ],
    "telemetry_rules": [
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4103,
        "details": "powershell.exe -Command findstr 127.0.0.1 C:\\Windows\\System32\\drivers\\etc\\hosts"
      },
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4104,
        "details": "findstr 127.0.0.1 C:\\Windows\\System32\\drivers\\etc\\hosts"
      }
    ]
  },
  {
    "primitive_id": "PS-032",
    "primitive_command": "New-Item -Path C:\\Users\\Public\\Documents\\ -Name \"sentinel_test_file.txt\" -ItemType File",
    "intent": [
      "Local Data Staging"
    ],
    "mitre_ttps": [
      "T1074.001"
    ],
    "telemetry_rules": [
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4103,
        "details": "powershell.exe -Command New-Item -Path C:\\Users\\Public\\Documents\\ -Name sentinel_test_file.txt -ItemType File"
      },
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4104,
        "details": "New-Item -Path C:\\Users\\Public\\Documents\\ -Name sentinel_test_file.txt -ItemType File"
      }
    ]
  },
  {
    "primitive_id": "PS-033",
    "primitive_command": "Add-Content -Path C:\\Users\\Public\\Documents\\sentinel_test_log.log -Value \"log entry 1\"",
    "intent": [
      "Local Data Staging"
    ],
    "mitre_ttps": [
      "T1074.001"
    ],
    "telemetry_rules": [
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4103,
        "details": "powershell.exe -Command Add-Content -Path C:\\Users\\Public\\Documents\\sentinel_test_log.log -Value log entry 1"
      },
      {
        "source": "WinEventLog:Microsoft-Windows-PowerShell/Operational",
        "event_id": 4104,
        "details": "{ Set-StrictMode -Version 1; $_.OriginInfo }"
      }
    ]
  }
]